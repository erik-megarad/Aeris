import os

from asyncpg import Pool, create_pool
from bcrypt import gensalt, hashpw
from pgvector.asyncpg import register_vector

from aeris.env import env

env()

DATABASE_URL = os.getenv("DATABASE_URL")


# Create a connection pool globally
_pool: Pool | None = None


async def init_db_pool():
    """
    Initializes the database connection pool.
    """
    global _pool
    if _pool is None:
        _pool = await create_pool(DATABASE_URL)


async def close_db_pool():
    """
    Closes the database connection pool.
    """
    global _pool
    if _pool:
        await _pool.close()
        _pool = None


class DB:
    """
    A context manager for acquiring a database connection.
    Ensures that the connection is released back to the pool.
    """

    def __init__(self):
        if _pool is None:
            raise RuntimeError(
                "Database pool not initialized. Call init_db_pool() first."
            )

    async def __aenter__(self):
        self.conn = await _pool.acquire()
        await register_vector(self.conn)
        return self.conn

    async def __aexit__(self, exc_type, exc_val, exc_tb):
        await _pool.release(self.conn)


async def drop_db():
    async with DB() as conn:
        await conn.execute("DROP TABLE IF EXISTS task_embeddings")
        await conn.execute("DROP TABLE IF EXISTS task_metadata")
        await conn.execute("DROP TABLE IF EXISTS events")
        await conn.execute("DROP TABLE IF EXISTS user_projects")
        await conn.execute("DROP TABLE IF EXISTS api_keys")
        await conn.execute("DROP TABLE IF EXISTS users")
        await conn.execute("DROP TABLE IF EXISTS task_tools")
        await conn.execute("DROP TABLE IF EXISTS tools")
        await conn.execute("DROP TABLE IF EXISTS tasks")
        await conn.execute("DROP TABLE IF EXISTS projects")


async def init_db():
    async with DB() as conn:
        await conn.execute('CREATE EXTENSION IF NOT EXISTS "uuid-ossp";')
        await conn.execute("CREATE EXTENSION IF NOT EXISTS vector;")

        await conn.execute(
            """
            CREATE TABLE IF NOT EXISTS projects (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                name TEXT NOT NULL, -- User-defined name of the project
                description TEXT, -- Optional description of the project
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE IF NOT EXISTS tasks (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                project_id INT NOT NULL REFERENCES projects(id) ON DELETE CASCADE, -- Links task to project
                name TEXT NOT NULL, -- User-defined name of the task
                input TEXT NOT NULL, -- Task input
                success BOOLEAN, -- Task success status, null is incomplete
                feedback TEXT, -- Human feedback on task output
                state TEXT NOT NULL DEFAULT 'PENDING', -- Task state (e.g., "PENDING", "RUNNING", "COMPLETED")
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE task_embeddings (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                task_id INT NOT NULL REFERENCES tasks(id) ON DELETE CASCADE, -- Links embedding to task
                embedding VECTOR(1536) NOT NULL -- Vector representation of the task
            );
        """
        )

        await conn.execute(
            """
           CREATE TABLE users (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                username TEXT UNIQUE NOT NULL, -- Unique identifier for the user (Must match github username)
                email TEXT UNIQUE, -- Email for user account (Must match github email)
                github_id TEXT UNIQUE, -- Optional GitHub ID for user account
                created_at TIMESTAMPTZ DEFAULT NOW() -- Timestamp of user creation
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE user_projects (
                user_id INT NOT NULL REFERENCES users(id) ON DELETE CASCADE, -- Links user to project
                project_id INT NOT NULL REFERENCES projects(id) ON DELETE CASCADE, -- Links user to project
                PRIMARY KEY (user_id, project_id)
            );
        """
        )

        await conn.execute(
            """
           CREATE TABLE task_metadata (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                task_id INT NOT NULL REFERENCES tasks(id) ON DELETE CASCADE, -- Links to task
                key TEXT NOT NULL, -- Metadata key (e.g., "execution_time", "goals")
                value JSONB NOT NULL -- Metadata value (e.g., "12s", "['goal1', 'goal2']")
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE events (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                task_id INT NOT NULL REFERENCES tasks(id) ON DELETE CASCADE, -- Links to task
                event_type TEXT NOT NULL, -- Type of event (e.g., "TASK_CREATED", "EMBEDDING_GENERATED")
                event_data JSONB NOT NULL, -- Payload associated with the event
                created_at TIMESTAMPTZ DEFAULT NOW() -- Timestamp of event creation
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE tools (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(),
                name TEXT NOT NULL, -- Tool name
                description TEXT, -- Optional description of the tool
                parameters JSONB, -- Optional parameters for the tool
                created_at TIMESTAMPTZ DEFAULT NOW()
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE task_tools (
                task_id INT NOT NULL REFERENCES tasks(id) ON DELETE CASCADE,
                tool_id INT NOT NULL REFERENCES tools(id) ON DELETE CASCADE,
                PRIMARY KEY (task_id, tool_id)
            );
        """
        )

        await conn.execute(
            """
            CREATE TABLE api_keys (
                id SERIAL PRIMARY KEY,
                uuid UUID DEFAULT gen_random_uuid(), 
                user_id INT NOT NULL REFERENCES users(id) ON DELETE CASCADE, -- API key belongs to a user
                project_id INT NOT NULL REFERENCES projects(id) ON DELETE CASCADE, -- API key linked to a project
                key TEXT NOT NULL UNIQUE, -- The actual API key (hashed for security)
                created_at TIMESTAMPTZ DEFAULT NOW(), -- Timestamp when the key was created
                expires_at TIMESTAMPTZ, -- Optional expiration date
                active BOOLEAN DEFAULT TRUE -- Whether the key is currently active
            );
        """
        )

        await conn.execute("CREATE INDEX ON tasks (project_id);")
        await conn.execute("CREATE INDEX ON task_embeddings (task_id);")
        await conn.execute("CREATE INDEX ON user_projects (user_id);")
        await conn.execute("CREATE INDEX ON user_projects (project_id);")
        await conn.execute("CREATE INDEX ON task_metadata (task_id);")
        await conn.execute("CREATE INDEX ON events (task_id);")
        await conn.execute("CREATE INDEX ON task_tools (task_id);")
        await conn.execute("CREATE INDEX ON task_tools (tool_id);")

        await conn.execute("CREATE INDEX ON tasks (name);")
        await conn.execute("CREATE INDEX ON tasks (state);")
        await conn.execute("CREATE INDEX ON projects (name);")
        await conn.execute("CREATE INDEX ON users (username);")
        await conn.execute("CREATE INDEX ON tools (name);")
        await conn.execute(
            "CREATE INDEX ON task_embeddings USING hnsw (embedding vector_l2_ops)"
        )

        await conn.execute("CREATE INDEX ON tasks (uuid);")
        await conn.execute("CREATE INDEX ON projects (uuid);")
        await conn.execute("CREATE INDEX ON users (uuid);")
        await conn.execute("CREATE INDEX ON task_embeddings (uuid);")
        await conn.execute("CREATE INDEX ON task_metadata (uuid);")
        await conn.execute("CREATE INDEX ON events (uuid);")
        await conn.execute("CREATE INDEX ON tools (uuid);")

        prod_flag = os.environ.get("ENVIRONMENT", "development") == "production"
        if not prod_flag:
            await conn.execute(
                "INSERT INTO users (username, email, github_id) VALUES ('erik-megarad', 'e@eriklp.com', '1234567890');"
            )
            await conn.execute(
                "INSERT INTO projects (uuid, name, description) VALUES ('36e8705e-6604-4e44-b58f-4e8c347a9f31', 'Test Project', 'A project for testing purposes');"
            )
            await conn.execute(
                "INSERT INTO user_projects (user_id, project_id) VALUES (1, 1);"
            )

            result = await conn.fetchrow(
                "INSERT INTO tasks (uuid, project_id, name, input, state) VALUES ('123e4567-e89b-12d3-a456-426614174000', 1, 'Test Task', 'Write a blog post about the latest news stories', 'PENDING') RETURNING id;"
            )

            embedding = [
                0.0036333168391138315,
                0.012326747179031372,
                0.018881600350141525,
                -0.009253148920834064,
                -0.015490936115384102,
                0.014015608467161655,
                -0.035381972789764404,
                -0.018842775374650955,
                0.004500395152717829,
                -0.03258661553263664,
                -0.0009188441326841712,
                0.008916670456528664,
                -0.01741921529173851,
                -0.01818276196718216,
                0.0016694492660462856,
                0.0003635743341874331,
                0.03825497627258301,
                -0.0036462582647800446,
                0.007454284932464361,
                -0.014093257486820221,
                -0.0038986168801784515,
                0.006897801999002695,
                -0.0047236355021595955,
                0.019606322050094604,
                -0.0037853792309761047,
                -0.013290886767208576,
                0.007402519229799509,
                0.010683180764317513,
                -0.005422474816441536,
                -0.0036333168391138315,
                0.02522291988134384,
                -0.009770807810127735,
                0.0020237218122929335,
                0.004888639319688082,
                0.009246678091585636,
                0.008580192923545837,
                -0.0033259571064263582,
                -0.004244801122695208,
                0.01525798998773098,
                -0.013989726081490517,
                0.02338523045182228,
                0.004393627867102623,
                0.0015028278576210141,
                -0.012702049687504768,
                -0.012812052853405476,
                -0.016047419980168343,
                0.019360434263944626,
                -0.016409780830144882,
                -0.02093929424881935,
                0.0003265698323957622,
                0.007402519229799509,
                -0.0018166584195569158,
                -0.0405326746404171,
                -0.009854926727712154,
                -0.01303852815181017,
                -0.010987305082380772,
                0.018726302310824394,
                0.013860311359167099,
                -0.0045877499505877495,
                -0.009046085178852081,
                0.004351568408310413,
                0.005726599134504795,
                0.004503630567342043,
                0.00022344251920003444,
                -0.0073248702101409435,
                -0.007512521464377642,
                -0.018959248438477516,
                0.013051469810307026,
                -0.009046085178852081,
                -0.00408626813441515,
                0.03271602839231491,
                -0.00715663144364953,
                -0.014015608467161655,
                -0.026491183787584305,
                0.01261145994067192,
                -0.019528673961758614,
                0.0068201529793441296,
                0.003879204858094454,
                -0.003746554721146822,
                0.008890788070857525,
                0.027461793273687363,
                0.013407359831035137,
                -0.0170180294662714,
                0.01555564347654581,
                0.030541861429810524,
                -0.0108514204621315,
                -0.00312374671921134,
                0.010676709935069084,
                -0.008741960860788822,
                -0.007499580271542072,
                0.0015982711920514703,
                -0.0005734687438234687,
                -0.0010061990469694138,
                0.0011000246740877628,
                -0.01925690285861492,
                0.03227601945400238,
                -0.016992146149277687,
                0.019373375922441483,
                0.007305458188056946,
                -0.018402766436338425,
                0.010385527275502682,
                -0.004788342863321304,
                -0.04394922032952309,
                -0.018053347244858742,
                -0.0022016670554876328,
                0.019088663160800934,
                0.00887137558311224,
                -0.0085090147331357,
                0.04055855795741081,
                0.0018490121001377702,
                -0.02057693339884281,
                0.011407903395593166,
                0.011356137692928314,
                -0.015542701818048954,
                0.00048813596367836,
                -0.011705556884407997,
                0.024058187380433083,
                -0.023009927943348885,
                0.011045542545616627,
                -0.022841690108180046,
                0.04363862797617912,
                0.0004367745132185519,
                0.0045198071748018265,
                -0.023475822061300278,
                -0.002208137884736061,
                0.01970985345542431,
                -0.02470526099205017,
                -0.025740578770637512,
                0.0011469374876469374,
                0.011530847288668156,
                0.007085453253239393,
                0.003135070437565446,
                0.004348332993686199,
                0.0018150407122448087,
                -0.013103235512971878,
                0.01850629784166813,
                -0.0077131143771111965,
                0.0210298839956522,
                -0.029506545513868332,
                -0.031939540058374405,
                0.011906149797141552,
                0.042344480752944946,
                -0.007007804233580828,
                0.0013240738771855831,
                0.0095119783654809,
                0.018053347244858742,
                0.019567498937249184,
                0.00022829556837677956,
                0.02146989293396473,
                -0.004752753768116236,
                -0.0012779699172824621,
                -0.011776735074818134,
                0.0226605087518692,
                -0.0174968633800745,
                -0.0065160286612808704,
                0.01638389751315117,
                0.017561571672558784,
                0.014015608467161655,
                -0.003225660650059581,
                -0.012766757048666477,
                0.007544875144958496,
                0.01690155640244484,
                0.03760790452361107,
                0.006897801999002695,
                -0.0020415163598954678,
                0.03323368728160858,
                0.022854629904031754,
                0.013290886767208576,
                -0.014416794292628765,
                -0.008502543903887272,
                -0.012656754814088345,
                0.010217288509011269,
                -0.04317273572087288,
                0.009181970730423927,
                -0.0039406768046319485,
                0.023851124569773674,
                -0.0017907754518091679,
                0.007376636378467083,
                -0.007564287632703781,
                -0.028522992506623268,
                -0.0014761360362172127,
                0.0075513459742069244,
                0.03558903560042381,
                0.030748926103115082,
                -0.010275525040924549,
                -0.005678068846464157,
                0.007732526399195194,
                -0.02139224484562874,
                -0.019476907327771187,
                -0.004432452376931906,
                0.010100815445184708,
                0.021042825654149055,
                0.01782039925456047,
                -0.006891331169754267,
                -0.6882789731025696,
                -0.02567587047815323,
                0.014481501653790474,
                0.0027047665789723396,
                0.011388490907847881,
                -0.0014373116428032517,
                -0.007234279997646809,
                0.0013936342438682914,
                0.0020835762843489647,
                0.005354532040655613,
                0.011459669098258018,
                -0.0011331872083246708,
                0.010586120188236237,
                -0.00004092233575647697,
                -0.004623339045792818,
                -0.0010935539612546563,
                0.004351568408310413,
                -0.010100815445184708,
                0.007124277763068676,
                -0.004982464946806431,
                -0.032379548996686935,
                0.019916918128728867,
                -0.009725512936711311,
                -0.00581718934699893,
                0.00781017541885376,
                -0.006406026426702738,
                -0.02603823132812977,
                -0.0062151397578418255,
                -0.002020486630499363,
                0.04332803189754486,
                -0.023178167641162872,
                0.030904224142432213,
                0.006143961567431688,
                0.02451113797724247,
                0.062015511095523834,
                0.011893208138644695,
                -0.012889700941741467,
                0.028807705268263817,
                0.008657841011881828,
                0.03111128695309162,
                -0.0017713633133098483,
                -0.006208668928593397,
                -0.007635465357452631,
                0.008586663752794266,
                0.0020690171513706446,
                0.006088960450142622,
                0.017393331974744797,
                -0.0008727401727810502,
                0.04073973745107651,
                0.005021288990974426,
                0.01886865869164467,
                -0.004497159738093615,
                -0.01745803840458393,
                0.006237787194550037,
                0.00834724586457014,
                0.012300864793360233,
                0.022259322926402092,
                0.01577564887702465,
                0.00022202703985385597,
                0.014908569864928722,
                -0.005632773507386446,
                0.018130995333194733,
                -0.040144432336091995,
                -0.012184390798211098,
                -0.017768634483218193,
                0.011589083820581436,
                0.006150432396680117,
                0.004358039237558842,
                -0.005238058976829052,
                -0.028781821951270103,
                -0.008657841011881828,
                0.003400370478630066,
                -0.017794517800211906,
                -0.0029021240770816803,
                0.010146110318601131,
                0.010372585617005825,
                0.01978750340640545,
                -0.004807754885405302,
                -0.018609829246997833,
                0.022129908204078674,
                0.010042577981948853,
                -0.013692072592675686,
                -0.033259570598602295,
                -0.0016047419048845768,
                0.042836256325244904,
                0.02178048901259899,
                -0.02542998269200325,
                -0.022854629904031754,
                0.017186269164085388,
                0.013064410537481308,
                0.013601481914520264,
                0.025261742994189262,
                -0.017147444188594818,
                0.0068201529793441296,
                0.008043121546506882,
                0.023566411808133125,
                0.01379560399800539,
                0.020098097622394562,
                0.0095119783654809,
                0.0001350765669485554,
                -0.007273104507476091,
                0.00334860454313457,
                0.004306273069232702,
                0.005354532040655613,
                0.008955495432019234,
                0.014585033059120178,
                0.023255815729498863,
                0.009447271004319191,
                0.02691825106739998,
                -0.03036068193614483,
                0.016772141680121422,
                -0.01127201784402132,
                -0.011362608522176743,
                0.014805038459599018,
                -0.017005087807774544,
                -0.029428895562887192,
                0.023333465680480003,
                -0.003295221133157611,
                -0.0005164454341866076,
                0.000413520319852978,
                0.04099856689572334,
                0.01686273142695427,
                -0.0030363916885107756,
                -0.0008856816566549242,
                -0.007848999463021755,
                0.013206766918301582,
                -0.0033712522126734257,
                -0.01670743338763714,
                -0.02634882740676403,
                -0.02506762184202671,
                0.013219708576798439,
                0.0025187330320477486,
                0.027979452162981033,
                0.005684539210051298,
                0.00024265250249300152,
                0.008586663752794266,
                0.02615470439195633,
                -0.0071631018072366714,
                0.003691553371027112,
                -0.019412200897932053,
                -0.028393579646945,
                -0.002311669522896409,
                0.007421931251883507,
                0.01145319826900959,
                -0.004532748833298683,
                -0.037582021206617355,
                -0.01866159588098526,
                -0.00043313472997397184,
                0.0016362867318093777,
                0.01263734232634306,
                -0.012294393964111805,
                0.007583699654787779,
                -0.014326203614473343,
                0.0041930354200303555,
                -0.003148011863231659,
                -0.005312472116202116,
                -0.0016055507585406303,
                -0.015128575265407562,
                -0.020835762843489647,
                -0.006962509360164404,
                0.000615124125033617,
                0.018118053674697876,
                0.004338626749813557,
                0.006535440683364868,
                -0.01415796484798193,
                -0.02414877712726593,
                -0.019011015072464943,
                0.005959545727819204,
                0.004270683974027634,
                -0.009046085178852081,
                0.007538404781371355,
                0.010715534910559654,
                -0.013925018720328808,
                -0.027202963829040527,
                0.019515732303261757,
                0.012177920900285244,
                -0.009479624219238758,
                0.01097436435520649,
                0.030774809420108795,
                -0.001794010866433382,
                -0.01846747286617756,
                0.019671030342578888,
                -0.01187379565089941,
                -0.030179500579833984,
                0.015827413648366928,
                0.02026633732020855,
                -0.005781600251793861,
                0.04821990802884102,
                0.006017782259732485,
                -0.005655420944094658,
                0.004736577160656452,
                0.0026934428606182337,
                0.0023343171924352646,
                -0.013562657870352268,
                -0.008004297502338886,
                0.006826623808592558,
                -0.004438923206180334,
                0.006082489620894194,
                0.007292516529560089,
                0.011194368824362755,
                0.013601481914520264,
                0.009194912388920784,
                0.01822158508002758,
                -0.012773227877914906,
                -0.0058948383666574955,
                -0.035149022936820984,
                0.011110249906778336,
                -0.004629809875041246,
                0.029739491641521454,
                -0.009783749468624592,
                0.023009927943348885,
                -0.02407112903892994,
                -0.012999704107642174,
                -0.008308421820402145,
                -0.008056063205003738,
                -0.0012933379039168358,
                -0.011556729674339294,
                -0.0033291922882199287,
                -0.010980835184454918,
                0.00916902907192707,
                0.005037466064095497,
                -0.010683180764317513,
                -0.004982464946806431,
                -0.003481254680082202,
                0.029584193602204323,
                0.02057693339884281,
                -0.00627661170437932,
                0.03929029405117035,
                0.018208643421530724,
                -0.03540785238146782,
                -0.014999160543084145,
                0.013290886767208576,
                0.01251439843326807,
                0.005157174542546272,
                0.024821734055876732,
                -0.011019659228622913,
                0.018933366984128952,
                -0.016526253893971443,
                0.016552137210965157,
                0.0004347524081822485,
                -0.0029538897797465324,
                0.0026643245946615934,
                0.011013188399374485,
                -0.003214336931705475,
                0.017548630014061928,
                -0.0011056866496801376,
                0.02919594943523407,
                0.005212175659835339,
                -0.0037983206566423178,
                -0.010553766041994095,
                -0.04177505522966385,
                0.004804519470781088,
                0.001070097554475069,
                0.0005856013740412891,
                0.024122893810272217,
                -0.005373944062739611,
                0.005648950580507517,
                0.008101358078420162,
                -0.00283256359398365,
                0.01705685444176197,
                0.016927439719438553,
                0.006156902760267258,
                -0.006257199216634035,
                -0.004160681739449501,
                0.008741960860788822,
                -0.004992170725017786,
                -0.011919091455638409,
                -0.000548799114767462,
                -0.021521659567952156,
                -0.0023585823364555836,
                -0.011860854923725128,
                -0.02398053929209709,
                0.036779649555683136,
                -0.030748926103115082,
                0.02046046033501625,
                0.008774315007030964,
                0.0033971350640058517,
                -0.007557816803455353,
                0.002405495150014758,
                0.022362854331731796,
                -0.01239792536944151,
                -0.020085155963897705,
                0.011026130057871342,
                -0.004390392918139696,
                -0.022725217044353485,
                -0.02774650603532791,
                -0.019839268177747726,
                -0.00909138098359108,
                -0.02447231486439705,
                0.006703679915517569,
                0.004095974378287792,
                -0.004895109683275223,
                0.010456705465912819,
                -0.0008735490264371037,
                -0.0065839714370667934,
                0.0018813657807186246,
                0.03688318282365799,
                -0.003743319306522608,
                0.009007261134684086,
                0.007913706824183464,
                0.008916670456528664,
                0.014106199145317078,
                0.008256656117737293,
                -0.02603823132812977,
                -0.010411410592496395,
                0.012359101325273514,
                -0.0030460976995527744,
                -0.02414877712726593,
                -0.015309755690395832,
                -0.0031447764486074448,
                0.007751938886940479,
                -0.005403062328696251,
                -0.01573682390153408,
                -0.0012310571037232876,
                -0.001208409434184432,
                0.012190861627459526,
                0.004273919388651848,
                -0.00446480605751276,
                0.01573682390153408,
                0.0007712305523455143,
                0.004972758702933788,
                -0.003335663117468357,
                -0.026361769065260887,
                0.013705013319849968,
                0.12879347801208496,
                0.011239663697779179,
                -0.002445937367156148,
                0.021728722378611565,
                -0.00962845142930746,
                -0.023501703515648842,
                -0.02671118825674057,
                -0.013245591893792152,
                0.009822573512792587,
                -0.015529760159552097,
                0.019476907327771187,
                -0.002486379351466894,
                -0.009829044342041016,
                -0.009298443794250488,
                0.020175747573375702,
                0.00168724381364882,
                -0.0064674983732402325,
                -0.012559694238007069,
                -0.0006466689519584179,
                -0.012520869262516499,
                0.006412496790289879,
                -0.020758112892508507,
                0.005542183294892311,
                0.0027063842862844467,
                0.03724554181098938,
                0.0020026920828968287,
                -0.0038856754545122385,
                0.04389745742082596,
                -0.011595554649829865,
                -0.003681847359985113,
                -0.01067024003714323,
                -0.002751679392531514,
                -0.009647863917052746,
                0.02206520177423954,
                0.007557816803455353,
                0.04604573920369148,
                -0.00016166723798960447,
                0.020771054551005363,
                0.007680760696530342,
                -0.01109083741903305,
                0.004348332993686199,
                -0.0016112126177176833,
                0.00663897255435586,
                0.002653000643476844,
                0.0017632748931646347,
                -0.009240207262337208,
                -0.004710693843662739,
                0.03631375730037689,
                -0.004730106331408024,
                -0.015063867904245853,
                0.02699590101838112,
                -0.0008614163962192833,
                -0.02603823132812977,
                -0.004212447442114353,
                0.005542183294892311,
                0.0025057916063815355,
                0.006334848236292601,
                0.009900222532451153,
                -0.0180662889033556,
                -0.025404099375009537,
                -0.008955495432019234,
                -0.013226179406046867,
                -0.006768387276679277,
                0.0030072734225541353,
                -0.017367448657751083,
                -0.002284168964251876,
                -0.003520078957080841,
                -0.013730896636843681,
                -0.012928525917232037,
                -0.012727933004498482,
                -0.02135341987013817,
                -0.022595802322030067,
                -0.027177080512046814,
                0.0014502531848847866,
                0.04400098696351051,
                0.007078982423990965,
                0.028445344418287277,
                0.010540825314819813,
                -0.015827413648366928,
                0.01297382079064846,
                -0.029506545513868332,
                -0.007635465357452631,
                -0.0019282785942777991,
                -0.024640552699565887,
                0.01193203218281269,
                0.0026675600092858076,
                -0.01753568835556507,
                0.010178463533520699,
                -0.029299480840563774,
                0.03680553287267685,
                -0.006470733322203159,
                0.016720375046133995,
                0.018635712563991547,
                0.0005706378142349422,
                0.00933079794049263,
                0.01179614756256342,
                0.007033687550574541,
                -0.007616053335368633,
                0.0033938996493816376,
                0.0008452395559288561,
                -0.013193825259804726,
                -0.016836848109960556,
                -0.016280366107821465,
                -0.012909113429486752,
                -0.014507384970784187,
                0.012300864793360233,
                0.015503877773880959,
                0.012249098159372807,
                0.02346288040280342,
                0.012430279515683651,
                0.0393938273191452,
                -0.010722005739808083,
                0.01255322340875864,
                0.012643813155591488,
                -0.0034553715959191322,
                0.019373375922441483,
                0.03256073221564293,
                -0.0037239070516079664,
                0.0025090270210057497,
                -0.02642647549510002,
                0.003626846242696047,
                -0.03170659393072128,
                0.03243131563067436,
                0.015232106670737267,
                0.0006596103776246309,
                -0.01109083741903305,
                -0.011382020078599453,
                -0.01452032569795847,
                -0.009660805575549603,
                0.031085403636097908,
                0.00220328476279974,
                0.004167152568697929,
                -0.014662682078778744,
                -0.009647863917052746,
                -0.03470901399850845,
                -0.01738039031624794,
                0.0075513459742069244,
                0.01782039925456047,
                -0.009395505301654339,
                -0.00905255600810051,
                -0.022285206243395805,
                -0.02018868923187256,
                0.025171153247356415,
                -0.019282786175608635,
                0.01315500121563673,
                -0.028807705268263817,
                -0.012617930769920349,
                -0.007486638613045216,
                0.003600963158532977,
                0.02034398540854454,
                -0.01215203758329153,
                -0.024239366874098778,
                -0.003426253329962492,
                -0.004303037654608488,
                0.00687838951125741,
                -0.02699590101838112,
                -0.0051183500327169895,
                -0.006257199216634035,
                0.0036494936794042587,
                0.008198419585824013,
                0.04045502468943596,
                -0.011220252141356468,
                0.007176043465733528,
                0.021599307656288147,
                0.004594220779836178,
                -0.015426228754222393,
                -0.005529241636395454,
                -0.020732229575514793,
                -0.006302494555711746,
                -0.007959002628922462,
                0.021845197305083275,
                0.007040157914161682,
                -0.01087083201855421,
                0.016681551933288574,
                -0.016603901982307434,
                0.03504549339413643,
                -0.007674289867281914,
                -0.015141516923904419,
                -0.01965808868408203,
                -0.005836601834744215,
                -0.01730274222791195,
                -0.0013750308426097035,
                -0.022401679307222366,
                0.011103779077529907,
                -0.04449276253581047,
                -0.008159594610333443,
                0.014662682078778744,
                0.017432156950235367,
                0.024847617372870445,
                -0.01470150612294674,
                0.004985700361430645,
                0.001208409434184432,
                0.01215203758329153,
                0.0040765623562037945,
                -0.013316769152879715,
                -0.029299480840563774,
                -0.007848999463021755,
                -0.03753025457262993,
                0.016125068068504333,
                0.022453445941209793,
                0.03294897451996803,
                0.003733613295480609,
                -0.000008240074748755433,
                0.01954161562025547,
                -0.019968682900071144,
                0.02066752314567566,
                -0.007014275062829256,
                0.021249888464808464,
                -0.004639516118913889,
                -0.02202637679874897,
                -0.025093505159020424,
                -0.004946875851601362,
                -0.002195196459069848,
                -0.00687838951125741,
                0.015102691948413849,
                -0.0012270128354430199,
                -0.02135341987013817,
                0.021560484543442726,
                -0.009084910154342651,
                -0.028730057179927826,
                -0.023799357935786247,
                -0.025261742994189262,
                0.03162894397974014,
                0.019878093153238297,
                0.01239792536944151,
                0.03131835162639618,
                0.0007817454752512276,
                -0.024485256522893906,
                0.012624400667846203,
                -0.01379560399800539,
                -0.026361769065260887,
                -0.0012698814971372485,
                0.04868580028414726,
                0.0025187330320477486,
                -0.0019347493071109056,
                0.00510540883988142,
                0.04348332807421684,
                -0.009621980600059032,
                -0.0128573477268219,
                0.0035556680522859097,
                0.012934996746480465,
                -0.019438084214925766,
                -0.039186760783195496,
                -0.013743838295340538,
                -0.02699590101838112,
                0.011407903395593166,
                -0.003756260732188821,
                0.008599604479968548,
                -0.004141269251704216,
                -0.019192196428775787,
                -0.020693406462669373,
                0.00425450736656785,
                -0.026659421622753143,
                0.017872165888547897,
                0.00001790825990610756,
                -0.0012585576623678207,
                -0.0031075698789209127,
                -0.01009434461593628,
                -0.013135588727891445,
                0.0022793158423155546,
                -0.01994280144572258,
                0.018752185627818108,
                -0.02546880766749382,
                0.006218374706804752,
                0.004348332993686199,
                0.016073301434516907,
                -0.0008043930865824223,
                -0.02210402488708496,
                -0.002709619700908661,
                0.023436997085809708,
                -0.011414374224841595,
                -0.004995406139642,
                0.008657841011881828,
                -0.006603383459150791,
                0.009156088344752789,
                -0.0065613240003585815,
                -0.007124277763068676,
                -0.0005463725537993014,
                -0.022078143432736397,
                -0.019075723364949226,
                0.010275525040924549,
                -0.0049080513417720795,
                -0.009686687961220741,
                -0.01569799892604351,
                -0.011679673567414284,
                -0.0059983697719872,
                -0.024938207119703293,
                0.00624749343842268,
                0.001482606865465641,
                -0.008133712224662304,
                -0.011899678967893124,
                -0.004328920505940914,
                -0.0039665596559643745,
                0.0012634106678888202,
                0.0188298337161541,
                0.0010733329690992832,
                0.0012051741359755397,
                0.0195027906447649,
                -0.021159298717975616,
                -0.0038565571885555983,
                -0.01822158508002758,
                -0.01697920449078083,
                0.0028778587002307177,
                0.010288466699421406,
                0.002179019618779421,
                -0.014248555526137352,
                0.008741960860788822,
                -0.0048401085659861565,
                -0.030257150530815125,
                -0.018959248438477516,
                -0.01669449172914028,
                0.017678044736385345,
                -0.0027063842862844467,
                -0.023035811260342598,
                0.01594388671219349,
                0.020162805914878845,
                -0.02911830134689808,
                -0.006451321300119162,
                -0.021495776250958443,
                0.022401679307222366,
                -0.02026633732020855,
                -0.01801452226936817,
                0.015581526793539524,
                0.0024669670965522528,
                0.013692072592675686,
                -0.02766885608434677,
                0.018118053674697876,
                0.010230230167508125,
                0.0012448073830455542,
                -0.007014275062829256,
                0.009395505301654339,
                0.03126658499240875,
                0.0016370955854654312,
                -0.009065497666597366,
                0.006884860340505838,
                -0.016047419980168343,
                -0.02487349882721901,
                0.013925018720328808,
                -0.0010895098093897104,
                -0.020395752042531967,
                -0.02139224484562874,
                0.021327538415789604,
                0.019489848986268044,
                0.0025025561917573214,
                -0.0050245244055986404,
                -0.0025268213357776403,
                -0.024498196318745613,
                -0.0003368825709912926,
                -0.00914961751550436,
                -0.0034553715959191322,
                -0.002324610948562622,
                0.04601985588669777,
                0.0049759941175580025,
                -0.0047721657902002335,
                -0.010592591017484665,
                -0.003059039358049631,
                -0.01722509227693081,
                -0.02927359938621521,
                0.004442158620804548,
                -0.0032369843684136868,
                0.017483921721577644,
                -0.01978750340640545,
                0.011446727439761162,
                0.01002963725477457,
                -0.012339688837528229,
                0.006111607886850834,
                -0.02378641627728939,
                0.010191405192017555,
                0.00022202703985385597,
                -0.029532426968216896,
                -0.0011922327103093266,
                0.003947147633880377,
                -0.022996986284852028,
                0.016448603942990303,
                0.023838182911276817,
                0.0038694986142218113,
                -0.0066777970641851425,
                0.014830920845270157,
                -0.01938631758093834,
                -0.00709839491173625,
                -0.00252358615398407,
                -0.018118053674697876,
                -0.004484218545258045,
                0.01525798998773098,
                0.01585329696536064,
                -0.02766885608434677,
                -0.038306742906570435,
                0.014766213484108448,
                -0.019761620089411736,
                -0.013232650235295296,
                0.014727389439940453,
                0.010049048811197281,
                0.01090965699404478,
                -0.009317856281995773,
                -0.017652161419391632,
                -0.03313015401363373,
                -0.005843072198331356,
                0.009059026837348938,
                -0.008793726563453674,
                -0.012190861627459526,
                0.0025041738990694284,
                0.023074636235833168,
                -0.019722795113921165,
                -0.012359101325273514,
                -0.0026481477543711662,
                0.010146110318601131,
                -0.024964090436697006,
                -0.01745803840458393,
                0.002735502552241087,
                -0.013963842764496803,
                -0.007920177653431892,
                -0.0002976537507493049,
                -0.00510540883988142,
                0.0025947641115635633,
                0.001475327298976481,
                -0.002604470355436206,
                -0.012669696472585201,
                -0.022815806791186333,
                0.002751679392531514,
                0.011841442435979843,
                -0.018247468397021294,
                -0.014261496253311634,
                -0.020512225106358528,
                0.0025349098723381758,
                0.0005839837249368429,
                -0.021327538415789604,
                0.0009293591137975454,
                -0.03152541443705559,
                -0.0025009384844452143,
                0.002030192641541362,
                0.009214324876666069,
                -0.02823828160762787,
                0.00577512988820672,
                0.01507680956274271,
                -0.018234526738524437,
                0.0021062237210571766,
                0.24060775339603424,
                -0.021974610164761543,
                -0.004752753768116236,
                0.04480335861444473,
                0.0066777970641851425,
                0.0022259324323385954,
                0.015710940584540367,
                0.015542701818048954,
                -0.00751899229362607,
                -0.004066856112331152,
                0.007829587906599045,
                -0.005632773507386446,
                -0.007408990059047937,
                -0.005823660176247358,
                -0.00417362293228507,
                0.001845776685513556,
                -0.037426721304655075,
                -0.02178048901259899,
                -0.01674625836312771,
                -0.025132328271865845,
                0.022531094029545784,
                0.0057104225270450115,
                -0.004468041472136974,
                -0.013265003450214863,
                0.016836848109960556,
                0.025378216058015823,
                -0.0035330206155776978,
                0.00457480875775218,
                0.027280611917376518,
                0.02262168377637863,
                -0.0011849530274048448,
                -0.011964386329054832,
                0.024524079635739326,
                0.000710971828084439,
                -0.014416794292628765,
                0.0008476661168970168,
                0.021676957607269287,
                0.00411538640037179,
                0.005723363719880581,
                0.00411538640037179,
                -0.0009843603475019336,
                -0.006198962684720755,
                -0.0009552420233376324,
                0.0036074339877814054,
                0.011407903395593166,
                0.015154457651078701,
                0.00425450736656785,
                0.005843072198331356,
                0.01833805814385414,
                0.022971104830503464,
                -0.021728722378611565,
                0.0012043652823194861,
                0.02269933372735977,
                -0.021004000678658485,
                -0.007111336104571819,
                -0.004222153685986996,
                0.02454996295273304,
                0.029739491641521454,
                -0.000598542857915163,
                0.008858433924615383,
                0.01734156534075737,
                0.03160306438803673,
                -0.010502000339329243,
                0.029221832752227783,
                -0.001661360845901072,
                -0.0013693689834326506,
                -0.005703951697796583,
                0.0024524079635739326,
                0.0355631522834301,
                -0.015477994456887245,
                -0.005561595316976309,
                0.0095119783654809,
                0.0015537849394604564,
                -0.016681551933288574,
                -0.020253395661711693,
                -0.022000493481755257,
                0.01291558425873518,
                0.040144432336091995,
                0.03258661553263664,
                0.02434290014207363,
                -0.011284959502518177,
                0.000235777348279953,
                0.03408782556653023,
                -0.01782039925456047,
                0.01866159588098526,
                -0.03465724736452103,
                0.022492269054055214,
                -0.007331341039389372,
                -0.02258286066353321,
                -0.0024491725489497185,
                -0.005509829614311457,
                0.010404939763247967,
                -0.01002963725477457,
                -0.012158508412539959,
                -0.010864361189305782,
                -0.024964090436697006,
                -0.016603901982307434,
                0.021314596757292747,
                -0.030464213341474533,
                -0.004028031602501869,
                -0.014869745820760727,
                0.04420804977416992,
                0.01281852275133133,
                -0.0008662694599479437,
                -0.019735736772418022,
                0.0004695325915236026,
                -0.01339441817253828,
                0.0219875518232584,
                0.00786841195076704,
                -0.006554853171110153,
                -0.006260434631258249,
                -0.013730896636843681,
                0.027901802211999893,
                0.008703136816620827,
                -0.015685057267546654,
                0.008547838777303696,
                0.01946396566927433,
                -0.01914042979478836,
                -0.013523832894861698,
                -0.017678044736385345,
                -0.009861397556960583,
                -0.025662928819656372,
                0.0025575575418770313,
                -0.008949024602770805,
                -0.00016459928883705288,
                0.007493109442293644,
                0.006043665111064911,
                -0.007493109442293644,
                0.001011052168905735,
                -0.008580192923545837,
                0.012410867027938366,
                -0.006231316365301609,
                -0.014222672209143639,
                -0.005797777324914932,
                -0.004662163555622101,
                0.00504717230796814,
                0.004927463363856077,
                -0.013290886767208576,
                -0.0016492281574755907,
                0.009796690195798874,
                -0.016810964792966843,
                -0.00044203197467140853,
                0.004849814809858799,
                -0.02338523045182228,
                0.004273919388651848,
                -0.015115633606910706,
                0.029687725007534027,
                -0.009667275473475456,
                0.005011583212763071,
                0.01087083201855421,
                -0.0308783408254385,
                -0.017030971124768257,
                0.0012164978543296456,
                0.008534897118806839,
                -0.004024796187877655,
                -0.0013062793295830488,
                0.0025802049785852432,
                -0.042913906276226044,
                0.006671326234936714,
                0.0009851692011579871,
                -0.00874843169003725,
                0.03103363886475563,
                0.026840602979063988,
                -0.01167320366948843,
                -0.012708520516753197,
                -0.006787799298763275,
                -0.16637550294399261,
                0.0232299342751503,
                0.02586999349296093,
                -0.002737120259553194,
                0.019153371453285217,
                -0.015477994456887245,
                0.01281852275133133,
                0.010230230167508125,
                -0.002842269605025649,
                0.015193282626569271,
                0.003950383048504591,
                -0.0043548038229346275,
                -0.039989132434129715,
                -0.007823117077350616,
                -0.016474487259984016,
                0.007874882780015469,
                0.005781600251793861,
                0.012339688837528229,
                0.006525734905153513,
                -0.006622795946896076,
                0.030852457508444786,
                -0.024317016825079918,
                0.027824154123663902,
                -0.005610126070678234,
                -0.0018037169938907027,
                -0.0029846257530152798,
                -0.001075759413652122,
                0.015594467520713806,
                -0.004367745015770197,
                -0.01810511201620102,
                -0.0066777970641851425,
                0.005545418709516525,
                0.01686273142695427,
                0.0008492837660014629,
                0.021573426201939583,
                0.009854926727712154,
                -0.009505507536232471,
                -0.022958163172006607,
                -0.008735490031540394,
                0.024886440485715866,
                0.02823828160762787,
                0.029610076919198036,
                0.006703679915517569,
                0.0005811527371406555,
                0.00814665388315916,
                -0.03131835162639618,
                -0.00563600892201066,
                -0.01039199810475111,
                0.005289824679493904,
                0.001061200280673802,
                0.01245616190135479,
                -0.014106199145317078,
                0.015568585135042667,
                -0.01617683470249176,
                0.003084922209382057,
                0.03991148620843887,
                0.010592591017484665,
                0.02338523045182228,
                -0.00560689065605402,
                0.006736033596098423,
                -0.001622536452487111,
                0.005830131005495787,
                -0.010139639489352703,
                -0.0073248702101409435,
                -0.03587374836206436,
                -0.022802865132689476,
                -0.02594764158129692,
                -0.013368535786867142,
                -0.026141762733459473,
                0.017367448657751083,
                -0.04076562076807022,
                -0.01774275116622448,
                -0.0008978142868727446,
                -0.019334550946950912,
                0.014145023189485073,
                -0.0020398986525833607,
                -0.02535233460366726,
                -0.014067375101149082,
                -0.005610126070678234,
                0.01638389751315117,
                -0.018842775374650955,
                0.031085403636097908,
                -0.013989726081490517,
                -0.00835371669381857,
                -0.01766510307788849,
                0.025054680183529854,
                -0.016474487259984016,
                0.014054433442652225,
                -0.01629330776631832,
                -0.00832783430814743,
                0.008916670456528664,
                -0.00835371669381857,
                -0.007997826673090458,
                -0.005610126070678234,
                -0.01367913093417883,
                0.00048126079491339624,
                0.01565917581319809,
                0.026581773534417152,
                0.011802618391811848,
                -0.011162015609443188,
                -0.014947394840419292,
                0.032224252820014954,
                -0.038462039083242416,
                0.010340232402086258,
                0.023204050958156586,
                -0.019075723364949226,
                0.008321363478899002,
                0.0081725362688303,
                0.038384392857551575,
                -0.01722509227693081,
                -0.013989726081490517,
                0.028341813012957573,
                0.010010224767029285,
                -0.013019115664064884,
                0.011382020078599453,
                0.016280366107821465,
                -0.009641393087804317,
                0.010663769207894802,
                -0.0010798036819323897,
                -0.0018765127751976252,
                0.025248801335692406,
                -0.004121857229620218,
                0.0020819585770368576,
                0.0007518183556385338,
                -0.00044728946522809565,
                -0.00845077820122242,
                -0.0787876546382904,
                -0.01870041899383068,
                -0.005027759820222855,
                0.0025559398345649242,
                -0.0012035564286634326,
                0.020292220637202263,
                -0.003749790135771036,
                0.021806372329592705,
                -0.022996986284852028,
                0.016202716156840324,
                -0.007959002628922462,
                -0.02042163535952568,
                0.00845077820122242,
                0.012339688837528229,
                0.026245296001434326,
                -0.011077895760536194,
                -0.015516819432377815,
                -0.001860335934907198,
                -0.009479624219238758,
                0.004959817044436932,
                0.0011906150029972196,
                -0.006315435748547316,
                -0.019554557278752327,
                -0.02058987319469452,
                0.0019751915242522955,
                0.023320524021983147,
                -0.01427443791180849,
                0.026284119114279747,
                0.002221079310402274,
                -0.014934453181922436,
                -0.01873924396932125,
                -0.014429735951125622,
                -0.0034230181481689215,
                -0.004303037654608488,
                0.0013790751108899713,
                0.0021466659381985664,
                -0.027021782472729683,
                0.0019363670144230127,
                0.024653494358062744,
                -0.03711612895131111,
                -0.006415732204914093,
                0.020719287917017937,
                0.02382524125277996,
                -0.026374710723757744,
                -0.0028455050196498632,
                -0.005399826914072037,
                -0.014934453181922436,
                0.004383922088891268,
                0.0073378118686378,
                0.0034650778397917747,
                -0.025455866008996964,
                0.015374463051557541,
                -0.006826623808592558,
                -0.027177080512046814,
                0.014921511523425579,
                -0.016849789768457413,
                -0.005166880786418915,
                0.0070725115947425365,
                -0.015529760159552097,
                0.001620918745175004,
                0.011718498542904854,
                -0.012410867027938366,
                -0.0040765623562037945,
                0.02774650603532791,
                -0.0034650778397917747,
                0.0015578290913254023,
                -0.005791306495666504,
                -0.0005532476934604347,
                0.03059362806379795,
                -0.004319214727729559,
                -0.018118053674697876,
                0.01581447198987007,
                -0.009181970730423927,
                0.02242756262421608,
                -0.014416794292628765,
                -0.0032838971819728613,
                -0.0034327241592109203,
                0.0019865152426064014,
                0.012993233278393745,
                0.017354506999254227,
                -0.014753272756934166,
                -0.024381723254919052,
                -0.008489602245390415,
                -0.009764336980879307,
                0.009583156555891037,
                0.006176315248012543,
                0.017121560871601105,
                0.0109937759116292,
                -0.0040086195804178715,
                -0.029014769941568375,
                -0.0020010743755847216,
                0.02722884714603424,
                -0.008534897118806839,
                0.011375549249351025,
                -0.010747888125479221,
                0.0075513459742069244,
                -0.014106199145317078,
                -0.01325206272304058,
                0.007480167783796787,
                0.0032127192243933678,
                0.011822029948234558,
                0.0016249630134552717,
                -0.06439673900604248,
                0.021094590425491333,
                0.007117806933820248,
                -0.014792096801102161,
                0.0008120770798996091,
                0.0025041738990694284,
                -0.019269844517111778,
                0.0015982711920514703,
                -0.0038436157628893852,
                0.009000790305435658,
                -0.024239366874098778,
                0.01197732798755169,
                0.006833094637840986,
                -0.010404939763247967,
                -0.0009285502601414919,
                0.00040664515108801425,
                0.03336310386657715,
                -0.00223240302875638,
                0.005448357667773962,
                -0.012171450071036816,
                -0.028341813012957573,
                0.002525203861296177,
                0.01697920449078083,
                0.01674625836312771,
                -0.014779155142605305,
                0.014921511523425579,
                -0.014248555526137352,
                0.012242628261446953,
                -0.010256112553179264,
                -0.0370902456343174,
                -0.023087577894330025,
                -0.030826574191451073,
                0.008463719859719276,
                0.00475598918274045,
                -0.009401976130902767,
                -0.010728476569056511,
                -0.015387404710054398,
                0.03227601945400238,
                -0.016798024997115135,
                0.028937119990587234,
                -0.013265003450214863,
                -0.00507629057392478,
                0.009686687961220741,
                -0.010683180764317513,
                -0.01157614216208458,
                0.0028244752902537584,
                -0.016875673085451126,
                0.00411538640037179,
                0.020447518676519394,
                -0.013653247617185116,
                0.008573722094297409,
                0.002457261085510254,
                -0.023734651505947113,
                -0.017289800569415092,
                -0.002950654597952962,
                -0.0060371942818164825,
                -0.013316769152879715,
                0.020240454003214836,
                0.016112126410007477,
                -0.005377179477363825,
                0.022375795990228653,
                0.02074517123401165,
                0.01361442357301712,
                0.001980044413357973,
                0.004506865981966257,
                0.006124549079686403,
                -0.00935020949691534,
                0.00002363334351684898,
                0.0028762409929186106,
                -0.024122893810272217,
                0.004849814809858799,
                0.009841986000537872,
                0.013860311359167099,
                0.02539115771651268,
                0.016590960323810577,
                -0.0081725362688303,
                0.008657841011881828,
                -0.004487453494220972,
                -0.004930698778480291,
                -0.002128871390596032,
                0.0036494936794042587,
                0.008851963095366955,
                -0.004765695426613092,
                0.018933366984128952,
                0.006367201916873455,
                0.00823077280074358,
                -0.0018134231213480234,
                -0.030412446707487106,
                -0.007124277763068676,
                0.01602153666317463,
                -0.015115633606910706,
                -0.009020202793180943,
                -0.01397678442299366,
                0.015167399309575558,
                0.005357767455279827,
                0.012941466644406319,
                -0.014947394840419292,
                0.008036650717258453,
                0.0023407877888530493,
                -0.00887137558311224,
                0.01090965699404478,
                -0.009505507536232471,
                -0.010366114787757397,
                -0.024782909080386162,
                -0.01810511201620102,
                0.01470150612294674,
                -0.014080315828323364,
                -0.016966262832283974,
                0.0029571251943707466,
                0.020046332851052284,
                -0.023281699046492577,
                0.005302766337990761,
                0.000084726169006899,
                0.013032057322561741,
                -0.021418128162622452,
                0.007363694719970226,
                0.014869745820760727,
                -0.015762707218527794,
                -0.022608742117881775,
                0.03799614682793617,
                -0.0015796677907928824,
                -0.016849789768457413,
                0.009188441559672356,
                -0.015607409179210663,
                0.0072083971463143826,
                0.0019056310411542654,
                0.017561571672558784,
                -0.027021782472729683,
                0.004875697661191225,
                -0.021702840924263,
                -0.013808545656502247,
                0.0064674983732402325,
                -0.02422642707824707,
                -0.0037756729871034622,
                0.01485680416226387,
                0.007848999463021755,
                -0.04045502468943596,
                0.03628787398338318,
                -0.00021858947002328932,
                0.06336142122745514,
                0.011187897995114326,
                -0.005584243219345808,
                0.014999160543084145,
                -0.0033550753723829985,
                0.006742504425346851,
                0.014481501653790474,
                0.010624944232404232,
                -0.012656754814088345,
                -0.014067375101149082,
                0.005645715165883303,
                0.022155791521072388,
                -0.014054433442652225,
                -0.01589212194085121,
                -0.002056075492873788,
                0.0032596320379525423,
                -0.010657298378646374,
                -0.004273919388651848,
                0.002099753124639392,
                -0.004542455077171326,
                0.014481501653790474,
                0.0170180294662714,
                0.013265003450214863,
                0.00935020949691534,
                -0.0072989873588085175,
                0.0027549148071557283,
                0.0033162508625537157,
                -0.01877806894481182,
                -0.012624400667846203,
                -0.031810127198696136,
                -0.00007097586058080196,
                -0.016759200021624565,
                -0.014623858034610748,
                -0.015387404710054398,
                0.02311345934867859,
                0.003217572346329689,
                -0.010061990469694138,
                -0.009958459064364433,
                0.007176043465733528,
                0.015270930714905262,
                -0.0011962768621742725,
                -0.012482045218348503,
                -0.018402766436338425,
                -0.018389824777841568,
                -0.019282786175608635,
                0.02206520177423954,
                0.014041491784155369,
                0.009214324876666069,
                -0.029299480840563774,
            ]
            await conn.execute(
                "INSERT INTO task_embeddings (task_id, embedding) VALUES ($1, $2) RETURNING *",
                result["id"],
                embedding,
            )

            test_api_key = os.getenv("TEST_API_KEY", "TEST")

            hashed_api_key = hashpw(test_api_key.encode(), gensalt())
            await conn.execute(
                "INSERT INTO api_keys (user_id, project_id, key) VALUES (1, 1, $1);",
                hashed_api_key.decode(),
            )


async def refresh_db():
    await init_db_pool()
    await drop_db()
    await init_db()
